# AWS EC2インスタンスにWSL2上のUbuntuからSSHで接続する

## 環境

- Windows 11 Pro, 24H2, 26100.3476
- Windows Subsystem for Linux (WSL2), Ubuntu 24.04.2 (LTS), 5.15.167.4-microsoft-standard-WSL2

## 1. AWSアカウントにログインする

左上のサービスアイコン >> すべてのサービス >> E >> EC2 (クラウド内の仮想サーバー)  
EC2のダッシュボードが表示される。

## 2. EC2インスタンスを起動する

黄色の「インスタンスを起動」ボタンを押す。

```
EC2 >> インスタンス >> インスタンスを起動

    名前とタグ
        SSH Test
    アプリケーションおよびOSイメージ(Amazonマシンイメージ)
        クイックスタート
            Amazon Linux
            Amazonマシンイメージ(AMI)
                Amazon Linux 2023 AMI 無料利用枠の対象
                    アーキテクチャ: 64ビット(x86)
                    Publish Date: 2025-03-04
                    ユーザー名: ec2-user
    インスタンスタイプ
        t2.micro 無料利用枠の対象
    キーペア(ログイン)
        キーペア名: SSH_TEST_KEY
        新しいキーペアの作成
            キーペア名: SSH_TEST_KEY
            キーペアのタイプ: ED25519 (よりセキュア)
            プライベートキーファイル形式: .pem (OpenSSH)
        キーペアを作成ボタンを押すとファイルがダウンロードされる。
    ネットワーク設定
        パブリックIPの自動割り当て: 有効化
        ファイアウォール(セキュリティグループ)
            [x]セキュリティグループを作成
            次のルールを使用して、「launch-wizard-1」という新しいセキュリティグループを作成します。
            [x]からのSSHトラフィックを許可: 自分のグローバルIP

インスタンスを起動ボタンを押す。
```

すべてのインスタンスを表示ボタンを押す。

```
EC2 >> インスタンス

    インスタンスを選択してパブリックIPv4アドレスを確認する。
```

## 3. WSL2上のUbuntuからSSHでEC2インスタンスに接続する

ホームディレクトリに.sshディレクトリを作成する。

```
~$ mkdir .ssh
```

.sshディレクトリにキーペアのファイル(.pem)をWindows上からコピーする。コピーしたあとにWSL2上に作成されるZone.Identifierファイルは削除する。

```
~$ cd .ssh
~/.ssh$ explorer.exe .
```

キーペアのファイルの権限を変更する。

```
~/.ssh$ chmod 600 SSH_TEST_KEY.pem
```

SSHで詳細情報を出力してEC2インスタンスに接続する。

```
~$ ssh -v -i ~/.ssh/SSH_TEST_KEY.pem ec2-user@<EC2インスタンスのパブリックIPv4アドレス>
```

## 4. EC2インスタンスを削除する

```
EC2 >> インスタンス

    1. インスタンスを選択する。
    2. 右上の「インスタンスの状態」から「インスタンスを終了(削除)」を選択する。
```
